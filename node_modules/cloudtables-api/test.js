
const Api = require('./dist/CloudTablesApi').default;

async function run () {
	const api = new Api('9w59r53jv1', 'qICNaTC2zF09FF7gkWwfkRX0', {
		secure: false,
		domain: 'ct-devel-06.io',
		// conditions: {id: 'dp-616', value: 2}
	});

	// Get data set schema
	let ds = api.dataset('94adbc6a-2510-11ec-8217-330db8c7d61e');
	// let schema = await ds.schema();
	// console.log('SCHEMA', schema);

	// New style script tag
	// let script = await ds.scriptTagAsync();
	// console.log('SCRIPT', script);

	// Legacy
	// let script2 = await api.scriptTagAsync('94adbc6a-2510-11ec-8217-330db8c7d61e');
	// console.log('SCRIPT2', script2);

	// // Rows
	// let data = await ds.data();
	// console.log('DATA', data);

	// // Create a new row
	// let res = await ds.insert({
	// 	'dp-616': 1000
	// });
	// console.log('Insert result:', res);

	// // Get row data
	// let rowId = res.data.id;

	// let row = ds.row(rowId);
	// let rowData = await row.data();
	// console.log('ROWDATA', rowData);

	// // Update row data
	// let resUp = await row.update({
	// 	'dp-616': 1001
	// });
	// console.log('RES-UPDATE', resUp);

	// // Delete data
	// let resDel = await row.delete();
	// console.log('RES-DELETE', resDel);

	// // Row data - not found
	// let row = ds.row(404);
	// let rowData = await row.data();
	// console.log('ROWDATA', rowData);

	// let rowDel404 = await row.data();
	// console.log('RowDel404', rowDel404);

	// let ds404 = api.dataset('404dbc6a-2510-11ec-8217-330db8c7d404');
	// let schema404 = await ds404.schema();
	// console.log('SCHEMA404', schema404);

	// let data404 = await ds404.schema();
	// console.log('SCHEMA404', data404);

	// Linked data
	let data = await ds.data();
	console.log('DATA', JSON.stringify(data, null, '  '));

	let resUp = await ds.row(1).update({
		'l-28': [1]
	});
	console.log('RES-UPDATE', JSON.stringify(resUp, null, '  '));


	let resUp2 = await ds.row(1).update({
		'dp-652': false,
	});
	console.log('RES-UPDATE2', JSON.stringify(resUp2, null, '  '));
}


run();

